<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æƒ…æ‡·å°‹å¯¶åœ– (ç›´å¼ç‰ˆ)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    /* ... å…¶ä»– CSS ... */
    .main-frame {
      position: relative;
      width: 95vw;
      max-width: 420px;
      /* â˜…â˜…â˜… ä¿®æ­£æ ¸å¿ƒï¼šè®“é«˜åº¦è‡ªé©æ‡‰å…§å®¹ï¼Œä¸¦è¨­å®šæœ€å¤§é«˜åº¦ â˜…â˜…â˜… */
      height: auto;
      max-height: 95vh;
      margin: auto; /* è®“å…¶åœ¨å‚ç›´ç½®ä¸­å’Œé ‚éƒ¨å°é½Šé–“å–å¾—å¹³è¡¡ */
      padding: 15px;
      background: rgba(35, 38, 50, 0.95);
      box-shadow: 0 0 80px #444, 0 0 0 6px #fce26a inset;
      border-radius: 24px;
      z-index: 2;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
     .title-screen, .game-over-screen {
        padding: 20px 0;
        min-height: 50vh; /* ç‚ºæ¨™é¡Œç•«é¢è¨­å®šæœ€å°é«˜åº¦ï¼Œé¿å…å…§å®¹å°‘æ™‚çœ‹èµ·ä¾†å¤ªç©º */
     }
    /* ... å…¶ä»– CSS ... */
  </style>
</head>
<body>
  <div id="root"></div>
  <audio id="sfx-found" src="audio/sfx-coin.mp3"></audio>
  <audio id="sfx-hint" src="audio/sfx-vhs.mp3"></audio>
  <audio id="bgm-main" src="audio/bgm-citypop.mp3" loop></audio>
  
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  
  <script>
    const e = React.createElement;
    // --- JavaScript å…§å®¹èˆ‡ä¸Šæ¬¡æä¾›çš„æœ€çµ‚ç‰ˆå®Œå…¨ç›¸åŒ ---
    const sceneData = {
      id: 'desk_90s_vertical',
      name: '90å¹´ä»£çš„æ›¸æˆ¿',
      background: 'assets/scene-desk-90s-vertical.jpg', 
      objects: [
        { id: 'gameboy', name: 'Game Boy', coords: { x: 65, y: 75, size: 18 } },
        { id: 'floppydisk', name: '3.5å‹ç£ç¢Ÿç‰‡', coords: { x: 25, y: 88, size: 12 } },
        { id: 'tamagotchi', name: 'é›»å­é›', coords: { x: 50, y: 55, size: 10 } },
        { id: 'yakult', name: 'é¤Šæ¨‚å¤š', coords: { x: 20, y: 65, size: 8 } }
      ]
    };
    const sfxElements = { found: () => document.getElementById("sfx-found"), hint: () => document.getElementById("sfx-hint") };
    function playSfx(name) { const el = sfxElements[name](); if (el) { el.currentTime = 0; el.play().catch(()=>{}); } }
    function App() {
      const [gameStatus, setGameStatus] = React.useState("TITLE");
      const [foundObjects, setFoundObjects] = React.useState([]);
      const [markers, setMarkers] = React.useState([]);
      const resetGame = () => { setFoundObjects([]); setMarkers([]); setGameStatus('PLAYING'); };
      const handleSceneClick = (event) => {
        if (gameStatus !== 'PLAYING') return;
        const rect = event.target.getBoundingClientRect();
        const clickX = ((event.clientX - rect.left) / rect.width) * 100;
        const clickY = ((event.clientY - rect.top) / rect.height) * 100;
        let hit = false;
        sceneData.objects.forEach(obj => {
          if (foundObjects.includes(obj.id)) return;
          const dist = Math.sqrt(Math.pow(clickX - obj.coords.x, 2) + Math.pow(clickY - obj.coords.y, 2));
          if (dist < obj.coords.size / 2) {
            hit = true;
            playSfx('found');
            const newFound = [...foundObjects, obj.id];
            setFoundObjects(newFound);
            setMarkers([...markers, { ...obj.coords, type: 'found' }]);
            if (newFound.length === sceneData.objects.length) {
              setTimeout(() => setGameStatus('COMPLETE'), 1000);
            }
          }
        });
      };
      const useHint = () => {
        const unfoundObject = sceneData.objects.find(obj => !foundObjects.includes(obj.id));
        if (unfoundObject) {
            playSfx('hint');
            const hintMarker = { ...unfoundObject.coords, type: 'hint', id: Date.now() };
            setMarkers([...markers, hintMarker]);
            setTimeout(() => {
                setMarkers(prev => prev.filter(m => m.id !== hintMarker.id));
            }, 1500);
        }
      };
      const shareForHelp = () => { alert('ã€åˆ†äº«æ±‚åŠ©ã€‘åŠŸèƒ½å°‡æœƒæˆªå–ç›®å‰ç•«é¢ï¼Œä¸¦è®“æ‚¨å‚³é€çµ¦æœ‹å‹ä¸€èµ·ä¾†å¹«å¿™æ‰¾å–”ï¼'); };
      const renderContent = () => {
        switch (gameStatus) {
          case 'PLAYING':
            return e('div', { className: 'game-container' },
              e('div', { className: 'scene-container', onClick: handleSceneClick },
                e('img', { src: sceneData.background, className: 'scene-background' }),
                ...markers.map((m, i) => e('div', { key: i, className: `${m.type}-marker`, style: { left: `${m.x}%`, top: `${m.y}%`, width: `${m.size}%`, height: `${m.size / (3/4)}%`, transform: 'translate(-50%, -50%)' } }))
              ),
              e('div', { className: 'hud' },
                e('div', { className: 'hud-title' }, `åœ¨ã€Œ${sceneData.name}ã€ä¸­æ‰¾å‡ºä»¥ä¸‹ç‰©å“ï¼š`),
                e('div', { className: 'object-list' },
                  ...sceneData.objects.map(obj => e('span', { key: obj.id, className: `object-item ${foundObjects.includes(obj.id) ? 'found' : ''}` }, obj.name))
                ),
                e('div', { className: 'game-actions' },
                  e('button', { className: 'action-btn', onClick: useHint }, 'ğŸ’¡ æç¤º'),
                  e('button', { className: 'action-btn', onClick: shareForHelp }, 'ğŸ§‘â€ğŸ¤â€ğŸ§‘ åˆ†äº«æ±‚åŠ©')
                )
              )
            );
          case 'COMPLETE':
            return e('div', { className: 'game-over-screen' },
              e('h2', { className: 'pixel-font', style: { color: "#F9DF5B" } }, "æ­å–œï¼å…¨éƒ¨æ‰¾åˆ°äº†ï¼"),
              e('p', {style:{color:"#fff"}}, `æ‚¨æˆåŠŸæ‰¾å‡ºäº†ã€Œ${sceneData.name}ã€ä¸­çš„æ‰€æœ‰ç§˜å¯†ï¼`),
              e('button', { className: "start-btn", onClick: () => setGameStatus('TITLE') }, "è¿”å›ä¸»é¸å–®")
            );
          default: // TITLE
            return e("div", { className: "title-screen" }, 
              e("h1", { className: "pixel-font", style: { color: "#F9DF5B" } }, "æƒ…æ‡·å°‹å¯¶åœ–"), 
              e("p", { style: { color: "#E383B9" } }, "åœ¨æ‡·èˆŠå ´æ™¯ä¸­ï¼Œæ‰¾å‡ºéš±è—çš„å¯¶ç‰©"), 
              e("button", { className: "start-btn", onClick: resetGame }, "é–‹å§‹å°‹å¯¶")
            );
        }
      };
      return e("div", { className: "crt-bg" },
        e("div", { className: "main-frame" }, renderContent())
      );
    }
    ReactDOM.createRoot(document.getElementById("root")).render(e(App));
  </script>
</body>
</html>
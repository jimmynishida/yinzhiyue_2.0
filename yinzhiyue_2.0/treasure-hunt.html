<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æƒ…æ‡·å°‹å¯¶åœ– (ç›´å¼ç‰ˆ)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    @font-face { font-family: 'pixel-font'; src: url('https://fonts.gstatic.com/s/pressstart2p/v12/e3t4euO8KNyBfB3R0rGJ.ttf') format('truetype'); }
    body { margin: 0; background: #222; font-family: 'Noto Sans TC', sans-serif; overflow: hidden; }
    .crt-bg { background-image: url('https://i.imgur.com/JxAiJ8B.jpg'); background-size: cover; background-position: center; min-height: 100vh; width: 100vw; position: fixed; inset: 0; display: flex; /* â˜…â˜…â˜… ç§»é™¤ align-items: center â˜…â˜…â˜… */ justify-content: center; padding-top: 20px; box-sizing: border-box; }
    
    .main-frame {
      position: relative;
      width: 95vw;
      max-width: 420px;
      height: auto;
      max-height: 95vh;
      margin: 0; /* â˜…â˜…â˜… ç§»é™¤ margin: auto â˜…â˜…â˜… */
      padding: 15px;
      background: rgba(35, 38, 50, 0.95);
      box-shadow: 0 0 80px #444, 0 0 0 6px #fce26a inset;
      border-radius: 24px;
      z-index: 2;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .title-screen, .game-over-screen { text-align: center; color: #fff; display: flex; flex-direction: column; justify-content: center; flex-grow: 1; padding: 20px 0; }
    .pixel-font { font-family: 'pixel-font', monospace; letter-spacing: 2px; }
    .start-btn { font-size: 1.5em; margin-top: 2em; background: #ffe5b5; border: 2px solid #f9df5b; color: #1d1821; border-radius: 8px; padding: 0.5em 1.5em; cursor: pointer; font-family: 'pixel-font', monospace; }
    
    .game-container { text-align: center; display: flex; flex-direction: column; height: 100%; }
    .scene-container {
      position: relative;
      cursor: crosshair;
      margin: 0 auto 15px auto;
      width: 100%;
      aspect-ratio: 3 / 4;
      flex-shrink: 0;
    }
    .scene-background { width: 100%; height: 100%; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
    .found-marker, .hint-marker { position: absolute; border-radius: 50%; box-sizing: border-box; pointer-events: none; }
    .found-marker { border: 3px solid #00ff41; background: rgba(0, 255, 65, 0.2); animation: fadeIn 0.5s; }
    .hint-marker { border: 4px dashed #ffeb3b; animation: pulse 1s infinite; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes pulse { 0% { transform: scale(0.9); opacity: 0.7; } 100% { transform: scale(1.2); opacity: 1; } }

    .hud { background: rgba(0,0,0,0.5); border-radius: 10px; padding: 10px; overflow-y: auto; flex-grow: 1; }
    .hud-title { color: #fce26a; font-family: 'pixel-font', monospace; margin-bottom: 10px; font-size: clamp(1em, 4vw, 1.2em); }
    .object-list { display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 15px; }
    .object-item { color: #fff; font-size: clamp(1em, 4vw, 1.1em); transition: color 0.5s, text-decoration 0.5s; }
    .object-item.found { color: #888; text-decoration: line-through; }
    .game-actions { margin-top: 15px; display: flex; justify-content: center; gap: 20px; }
    .action-btn { font-size: 1em; background: #5DADE2; border: none; color: #fff; padding: 8px 16px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <div id="root"></div>
  <audio id="sfx-found" src="audio/sfx-coin.mp3"></audio>
  <audio id="sfx-hint" src="audio/sfx-vhs.mp3"></audio>
  <audio id="bgm-main" src="audio/bgm-citypop.mp3" loop></audio>
  
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
  
  <script>
    const e = React.createElement;
    // --- JavaScript å…§å®¹èˆ‡ä¸Šæ¬¡ç‰ˆæœ¬ç›¸åŒ ---
    const sceneData = {
      id: 'desk_90s_vertical',
      name: '90å¹´ä»£çš„æ›¸æˆ¿',
      background: 'assets/scene-desk-90s-vertical.jpg', 
      objects: [
        { id: 'gameboy', name: 'Game Boy', coords: { x: 65, y: 75, size: 18 } },
        { id: 'floppydisk', name: '3.5å‹ç£ç¢Ÿç‰‡', coords: { x: 25, y: 88, size: 12 } },
        { id: 'tamagotchi', name: 'é›»å­é›', coords: { x: 50, y: 55, size: 10 } },
        { id: 'yakult', name: 'é¤Šæ¨‚å¤š', coords: { x: 20, y: 65, size: 8 } }
      ]
    };
    const sfxElements = { found: () => document.getElementById("sfx-found"), hint: () => document.getElementById("sfx-hint") };
    function playSfx(name) { const el = sfxElements[name](); if (el) { el.currentTime = 0; el.play().catch(()=>{}); } }
    function App() {
      const [gameStatus, setGameStatus] = React.useState("TITLE");
      const [foundObjects, setFoundObjects] = React.useState([]);
      const [markers, setMarkers] = React.useState([]);
      const resetGame = () => { setFoundObjects([]); setMarkers([]); setGameStatus('PLAYING'); };
      const handleSceneClick = (event) => {
        if (gameStatus !== 'PLAYING') return;
        const rect = event.target.getBoundingClientRect();
        const clickX = ((event.clientX - rect.left) / rect.width) * 100;
        const clickY = ((event.clientY - rect.top) / rect.height) * 100;
        let hit = false;
        sceneData.objects.forEach(obj => {
          if (foundObjects.includes(obj.id)) return;
          const dist = Math.sqrt(Math.pow(clickX - obj.coords.x, 2) + Math.pow(clickY - obj.coords.y, 2));
          if (dist < obj.coords.size / 2) {
            hit = true;
            playSfx('found');
            const newFound = [...foundObjects, obj.id];
            setFoundObjects(newFound);
            setMarkers([...markers, { ...obj.coords, type: 'found' }]);
            if (newFound.length === sceneData.objects.length) {
              setTimeout(() => setGameStatus('COMPLETE'), 1000);
            }
          }
        });
      };
      const useHint = () => {
        const unfoundObject = sceneData.objects.find(obj => !foundObjects.includes(obj.id));
        if (unfoundObject) {
            playSfx('hint');
            const hintMarker = { ...unfoundObject.coords, type: 'hint', id: Date.now() };
            setMarkers([...markers, hintMarker]);
            setTimeout(() => {
                setMarkers(prev => prev.filter(m => m.id !== hintMarker.id));
            }, 1500);
        }
      };
      const shareForHelp = () => { alert('ã€åˆ†äº«æ±‚åŠ©ã€‘åŠŸèƒ½å°‡æœƒæˆªå–ç›®å‰ç•«é¢ï¼Œä¸¦è®“æ‚¨å‚³é€çµ¦æœ‹å‹ä¸€èµ·ä¾†å¹«å¿™æ‰¾å–”ï¼'); };
      const renderContent = () => {
        switch (gameStatus) {
          case 'PLAYING':
            return e('div', { className: 'game-container' },
              e('div', { className: 'scene-container', onClick: handleSceneClick },
                e('img', { src: sceneData.background, className: 'scene-background' }),
                ...markers.map((m, i) => e('div', { key: i, className: `${m.type}-marker`, style: { left: `${m.x}%`, top: `${m.y}%`, width: `${m.size}%`, height: `${m.size / (3/4)}%`, transform: 'translate(-50%, -50%)' } }))
              ),
              e('div', { className: 'hud' },
                e('div', { className: 'hud-title' }, `åœ¨ã€Œ${sceneData.name}ã€ä¸­æ‰¾å‡ºä»¥ä¸‹ç‰©å“ï¼š`),
                e('div', { className: 'object-list' },
                  ...sceneData.objects.map(obj => e('span', { key: obj.id, className: `object-item ${foundObjects.includes(obj.id) ? 'found' : ''}` }, obj.name))
                ),
                e('div', { className: 'game-actions' },
                  e('button', { className: 'action-btn', onClick: useHint }, 'ğŸ’¡ æç¤º'),
                  e('button', { className: 'action-btn', onClick: shareForHelp }, 'ğŸ§‘â€ğŸ¤â€ğŸ§‘ åˆ†äº«æ±‚åŠ©')
                )
              )
            );
          case 'COMPLETE':
            return e('div', { className: 'game-over-screen' },
              e('h2', { className: 'pixel-font', style: { color: "#F9DF5B" } }, "æ­å–œï¼å…¨éƒ¨æ‰¾åˆ°äº†ï¼"),
              e('p', {style:{color:"#fff"}}, `æ‚¨æˆåŠŸæ‰¾å‡ºäº†ã€Œ${sceneData.name}ã€ä¸­çš„æ‰€æœ‰ç§˜å¯†ï¼`),
              e('button', { className: "start-btn", onClick: () => setGameStatus('TITLE') }, "è¿”å›ä¸»é¸å–®")
            );
          default: // TITLE
            return e("div", { className: "title-screen" }, 
              e("h1", { className: "pixel-font", style: { color: "#F9DF5B" } }, "æƒ…æ‡·å°‹å¯¶åœ–"), 
              e("p", { style: { color: "#E383B9" } }, "åœ¨æ‡·èˆŠå ´æ™¯ä¸­ï¼Œæ‰¾å‡ºéš±è—çš„å¯¶ç‰©"), 
              e("button", { className: "start-btn", onClick: resetGame }, "é–‹å§‹å°‹å¯¶")
            );
        }
      };
      return e("div", { className: "crt-bg" },
        e("div", { className: "main-frame" }, renderContent())
      );
    }
    ReactDOM.createRoot(document.getElementById("root")).render(e(App));
  </script>
</body>
</html>